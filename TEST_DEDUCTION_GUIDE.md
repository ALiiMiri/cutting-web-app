# راهنمای تست جریان کسر از انبار

## مراحل تست:

### 1. آماده‌سازی انبار:
- به صفحه "انواع پروفیل" بروید
- یک نوع پروفیل اضافه کنید (مثلاً "فریم لس قدیمی")
- به جزئیات آن پروفیل بروید
- تعداد مناسبی شاخه (مثلاً 10 عدد) به موجودی اضافه کنید

### 2. ایجاد پروژه و محاسبه برش:
- یک پروژه جدید ایجاد کنید
- چند درب با ابعاد مختلف اضافه کنید
- روی دکمه "محاسبه برش" کلیک کنید
- نتایج محاسبه برش را مشاهده کنید

### 3. کسر از انبار:
- در صفحه نتایج، دکمه **"کسر از انبار"** (با آیکون منفی قرمز) را خواهید دید
- روی آن کلیک کنید
- نوع پروفیل را از لیست انتخاب کنید
- موجودی فعلی را مشاهده می‌کنید
- اگر موجودی کافی است، تایید کنید
- پیام موفقیت نمایش داده می‌شود

### 4. بررسی تغییرات:
- به داشبورد انبار بروید
- بررسی کنید موجودی کم شده است
- در تاریخچه (Logs) ببینید رکورد کسر ثبت شده است
- اگر تکه‌های بزرگ (بیشتر از 70 سانتی‌متر) باقی مانده بود، در بخش "تکه‌های برش خورده" اضافه شده‌اند

## نکات مهم:
- هر محاسبه برش فقط یک بار قابل کسر از انبار است
- پس از کسر موفق، داده‌های محاسبه از session پاک می‌شوند
- اگر موجودی کافی نباشد، پیام خطا نمایش داده می‌شود
- تکه‌های باقی‌مانده کمتر از 70 سانتی‌متر به انبار اضافه نمی‌شوند (ضایعات)
- لاگ کامل با شماره پروژه در سیستم ثبت می‌شود

## خروجی موردانتظار:
✓ موجودی انبار کم می‌شود
✓ تکه‌های بزرگ باقی‌مانده به انبار اضافه می‌شوند
✓ لاگ در تاریخچه انبار ثبت می‌شود
✓ پیام موفقیت نمایش داده می‌شود

